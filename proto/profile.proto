syntax = "proto3";

package auth;

option go_package = "oneway/profile/v1;profilev1";
import "validate/validate.proto";
import "google/protobuf/field_mask.proto";


service ProfileService {
  rpc GetProfile(GetProfileRequest) returns (Profile);
  rpc UpdateProfile(UpdateProfileRequest) returns (UpdateProfileResponse);
}

message GetProfileRequest {
  int64 userID = 1 [(validate.rules).int64 = {gt: 0}];
}

message Profile {
  int64 userID = 1 [(validate.rules).int64 = {gt: 0}];
  optional string avatar_url = 2 [(validate.rules).string = {uri: true}];
  optional string display_name = 3 [(validate.rules).string = {min_len: 3, max_len: 50}];
  optional string bio = 4 [(validate.rules).string = {max_len: 200}];
  string username = 5 [(validate.rules).string = {pattern: "^[a-zA-Z0-9_]+$", min_len: 3, max_len: 30}];
  optional string surname = 6 [(validate.rules).string = {min_len: 2, max_len: 50}];
  string phoneNumber = 7 [(validate.rules).string = {pattern: "^\\+?[1-9]\\d{1,14}$"}];
  string email = 8 [(validate.rules).string = {email: true}];
}

message UpdateProfileRequest {
  int64 userID = 1 [(validate.rules).int64 = {gt: 0}];
  Profile profile = 2 [(validate.rules).message = {required: true}];
  google.protobuf.FieldMask update_mask = 3;
}

message UpdateProfileResponse {
  bool isSuccess = 1;
}